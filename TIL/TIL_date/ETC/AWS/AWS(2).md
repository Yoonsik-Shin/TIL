# AWS (2) - EC2

​    

> IAM 유저 결제 정보 열람 허용

- 루트 계정에서 설정

![image-20230604165719358](AWS(2).assets/image-20230604165719358.png)

​    

프리티어 확인법

![image-20230604170010802](AWS(2).assets/image-20230604170010802.png)

![image-20230604170016734](AWS(2).assets/image-20230604170016734.png)



비용초과 방지법

![image-20230604170159232](AWS(2).assets/image-20230604170159232.png)

​    

- Elastic Compute Cloud
- Infrastructure as a Service
- EC2 인스턴스 : 가상 머신 임대
- EBS 볼륨 : 가상 드라이브
- ELB (Elastic Load Balancer) : 부하분산
- ASG (Auto Scaling Group) : 서비스 확장



- 운영체제
  - Linux, window, mac
- 가상 머신에 사용할 컴퓨팅 성능과 코어 (CPU) 선택가능
- RAM 용량 선택가능
- EBS, EFS 용량 선택가능 (네트워크 기반)
- EC2 Instance Store (하드웨어 기반)
- EC2 인스턴스에 연결할 네트워크 유형 선택가능
  - 네트워크 카드의 속도, 사용할 공개 IP 설정가능
- 보안그룹 :  EC2 인스턴스의 방화벽 규칙 정의
- EC2 User Date : 부트스트랩 스크립트를 이용해 처음 시작할 때의 인스턴스 구성가능

 

EC2 사용자 데이터 (User Data)

- EC2가 시작될 때 부트스트래핑됨

- 부트스트래핑되는 것들

  - 업데이트 설치

  - 소프트웨어 설치

  - 인터넷에서 일반 파일 다운로드

  - 그 외 원하는 작업

- 스크립트는 루트 사용자로 실행됨

부트스트래핑

- 머신이 시작할 때 명령을 실행하는 것
- 스크립트는 처음 시작할 때 한 번 실행되고 다시는 실행되지 않음



EC2 인스턴스 타입

| Instance    | vCPU | Mem (GiB) | Storage          | Network Performance | EBS Bandwidth (Mbps) |
| ----------- | ---- | --------- | ---------------- | ------------------- | -------------------- |
| t2.micro    | 1    | 1         | EBS Only         | Low to Moderate     |                      |
| t2.xlarge   | 4    | 16        | EBS Only         | Moderate            |                      |
| c5d.4xlarge | 16   | 32        | 1 x 400 NVMe SSD | Up to 10 Gbps       | 4750                 |
| r5.16xlarge | 64   | 512       | EBS Only         | 20 Gbps             | 13600                |
| m5.8xlarge  | 32   | 128       | EBS Only         | 10 Gbps             | 6800                 |

> t2.micro는 프리티어가 지원됨

​    

EC2 인스턴스 시작하기

![image-20230604172106844](AWS(2).assets/image-20230604172106844.png)

![image-20230604172149129](AWS(2).assets/image-20230604172149129.png)

![image-20230604172216248](AWS(2).assets/image-20230604172216248.png)

![image-20230604172302842](AWS(2).assets/image-20230604172302842.png)

![image-20230604172323465](AWS(2).assets/image-20230604172323465.png)

![image-20230604172446741](AWS(2).assets/image-20230604172446741.png)

![image-20230604172534769](AWS(2).assets/image-20230604172534769.png)

![image-20230604172626301](AWS(2).assets/image-20230604172626301.png)

![image-20230604172901130](AWS(2).assets/image-20230604172901130.png)

- 프라이빗 IP는 항상 동일하게 유지됨
- 공개 IP는 바뀔 수 있음

​    

EC2 인스턴스 유형

https://aws.amazon.com/ko/ec2/instance-types/

네이밍 컨벤션

m5.2xlarge

- m : 인스턴스 클래스
- 5 : 인스턴스 세대
- 2xlarge : 인스턴스 클래스 내에서의 크기



1. 범용

   - 웹 서버, 코드저장소등의 작업에 적합
   - 컴퓨팅, 메모리, 네트워킹 간의 균형이 잘 맞음
   - 보통 프리티어 범용 인스턴스인 t2.micro를 많이 사용함

   ![image-20230604214536546](AWS(2).assets/image-20230604214536546.png)

2. 컴퓨팅 최적화

   - 일부 데이터의 일괄 처리
   - CPU와 컴퓨팅 파워에 특화 되어있음
   - C로 시작하는 이름을 가짐
   - 미디어 트랜스코딩 작업
   - 고성능 웹서버
   - HPC 작업
   - 머신러닝
   - 전용 게임 서버

   ![image-20230604214458212](AWS(2).assets/image-20230604214458212.png)

3. 메모리 최적화

   - 메모리에서 대규모 데이터셋을 처리하는 유형의 작업에서 빠른 성능 제공
   - 고성능의 관계형/비관계 DB에 사용
   - 분산 웹스케일 캐시 저장소 (일라스틱 캐시)
   - 비즈니스 인텔리전스에 최적화된 인 메모리 DB
   - 대규모 비정형 데이터의 실시간 처리를 실행하는 애플리케이션

   ![image-20230604214550108](AWS(2).assets/image-20230604214550108.png)

4. 스토리지 최적화
   - 로컬 스토리지에서 대규모의 데이터셋에 엑세스할 때 적합한 인스턴스
   - 고주파 온라인 트랜잭션 처리인 OLTP에 사용
   - 관계형 DB, NoSQL
   - 인 메모리 DB의 캐시 (Redis)
   - 데이터 웨어하우징 애플리케이션
   - 분산 파일 시스템

![image-20230604214854592](AWS(2).assets/image-20230604214854592.png)

​    

### EC2 인스턴스 방화벽

- 보안 그룹
  - AWS 클라우드에서 네트워크 보안을 실현하는 기본적인 기능
  - 인바운드 / 아웃바운드 트래픽을 제어함
  - 오직 허용 규칙만 사용함
  - IP 주소를 참조하거나, 다른 보안 그룹을 참조함 (보안 그룹끼리 서로 참조 가능)
  - 방화벽 역할을 함
  - 포트에 대한 엑세스를 관리
  - 인증된 IP 범위 확인 (IPv4, IPv6)
  - 외부에서 인스턴스로 연결하는 인바운드 네트워크 제어 (기본적으로 모든 인바운드 트래픽은 차단됨)
  - 인스턴스에서 외부로 연결하는 네트워크 제어 (기본적으로 모든 아웃바운드 트래픽 허용)
  - 여러 인스턴스와 하나의 보안그룹, 하나의 보안그룹에 여러 인스턴스를 가질 수 있음
  - 리전이나 특정 VPC 조합에 고정됨
  - EC2 외부에 존재하여 트래픽이 차단되면 EC2 인스턴스는 이를 확인할 수 없음
  - SSH 전용으로 별도 보안 그룹을 관리하는 것이 바람직함
  - 애플리케이션이 액세스할 수 없어서 타임아웃(timeout)이 발생한다면 이는 보안 그룹 문제
  - 연결 거부(connection refused) 오류 발생는 보안 그룹은 동작하고 트래픽은 통과했지만 애플리케이션 오류나 다른 요인이 문제일 수 있음

- 포트
  - 22 (SSH) Secure Shell : 리눅스 EC2 인스턴스에 로그인할 때 사용
  - 21 (FTP) File Transfer Protocol : 파일 전송 프로토콜로 파일 공유, 파일 업로드시 사용
  - 22 (SFTP) Secure File Transfer Protocol : 보안 파일 전송 프로토콜로 SSH를 활용하여 파일을 공유함
  - 80  (HTTP) : 보안이 적용되지 않은 웹사이트에 액세스할 때 사용
  - 443 (HTTPS) : 보안이 적용된 웹사이트
  - 3389 (RDP) Remot Desktop Protocol : 원격 데스크탑 프로토콜용, 윈도우 인스턴스 로그인에 사용됨